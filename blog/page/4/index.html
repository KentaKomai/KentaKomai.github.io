
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>KentaKomai's BLOG</title>
  <meta name="author" content="Kenta Komai">

  
  <meta name="description" content="vimの魅力はたくさんあって、マルチプラットフォーム、豊富なプラグイン、 軽量な動作（そうとは言えないときもあるけど）などなど人それぞれあると思いますが、 僕が何よりも気に入っているのは、やはり独特なキーバインド。 マウス操作に慣れている人にとっては、それがvimへのハードルを上げ、 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://KentaKomai.github.io/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="KentaKomai's BLOG" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46297904-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
	<div class="header-title"><a href="/">KentaKomai's BLOG</a></div>


	<br><div class="header-subtitle">自分用備忘録の延長</div>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="kaede06152000@gmail.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:KentaKomai.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/26/wordpress48/">使ってるだいたいの環境でvimキーバインドを使う</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-26T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>vimの魅力はたくさんあって、マルチプラットフォーム、豊富なプラグイン、 軽量な動作（そうとは言えないときもあるけど）などなど人それぞれあると思いますが、 僕が何よりも気に入っているのは、やはり独特な<strong>キーバインド</strong>。</p>

<p>マウス操作に慣れている人にとっては、それがvimへのハードルを上げ、なかなか馴染めない人も いるようですが、一度馴染んでしまうと本当にやめられない。</p>

<p>（controlやescを多用することもあるけど）ホームポジションからあまり手が離れず 普通のテキストエディタよりずっと高速にタイピングできます（と僕は信じています（笑））</p>

<p>よく使うキーバインドは、他の記事で紹介しましたので割愛します。 <a href="%22URL%22">以前の記事</a></p>

<p>今回はvim以外の環境で、簡単にvimのキーバインドを活用する、ということです。</p>

<p>僕はコーディングには、主にvimかsublimetext2を用いてますが 開発環境や、技術調査のためのブラウザでも、できればvimキーバインドを使いたいなーと思ってました。</p>

<p>vim好きの人の信仰っぷりは凄まじいですね・・・ｗ探せばだいたいのツールに対して vimキーバインドを使えるようにするプラグインが存在しました。今回ボクが利用しているものを 紹介します。</p>

<ol>
<li>Google Chromeでvimキーバインド</li>
<li>Eclipseでvimキーバインド</li>
<li>Visual Stduio(2010)でvimキーバインド</li>
<li>Sublimetext2でvimキーバインド</li>
</ol>


<p>以上の４つに関して紹介したいです。 たぶんvim好きな人は、既にほとんど知ってると思います。 むしろおすすめしたいのは<strong>これからvimを勉強したい！慣れたい！</strong>という人です。 これらを全て導入して、無理矢理キーバインドを体に馴染むようにすると<strong>一ヶ月もしないで</strong> 慣れます！（僕は違う環境だったけど、vimを使わないといけない状況で勝手に覚えた、<strong>辛かった</strong>）</p>

<h3>Google Chromeでvimキーバインド</h3>

<hr />

<p>GoogleChromeにvimキーバインドを追加してくれるプラグインはいくつかありますが 僕が使ってるのはvichromeです。 <a href="https://chrome.google.com/webstore/detail/vichrome/gghkfhpblkcmlkmpcpgaajbbiikbhpdi">vichrome -chrome web store-</a></p>

<p>ページ送りがhjklで可能です。検索も / で可能になります。以下にコマンドを挙げておきます。</p>

<pre>Normal Mode Mapping (nmap)
j : ScrollDown
k : ScrollUp
h : ScrollLeft
l : ScrollRight
&lt;C-f> : PageDown
&lt;C-b> : PageUp
&lt;C-d> : PageHalfDown
&lt;C-u> : PageHalfUp
gg : GoTop
G : GoBottom
t : TabOpenNew
x : TabCloseCurrent
X : TabCloseCurrent --focusprev
n : NextSearch
N : PrevSearch
gt : TabFocusNext
gT : TabFocusPrev
&lt;C-l> : TabFocusNext
&lt;C-h> : TabFocusPrev
r : TabReload
H : BackHist
L : ForwardHist
: : GoCommandMode
/ : GoSearchModeForward
? : GoSearchModeBackward
a : GoLinkTextSearchMode
f : GoFMode
F : GoFMode --newtab
; : GoExtFMode
i : FocusOnFirstInput
u : RestoreTab
gp : WinOpenNew --pop
gs : TabOpenNew --next view-source:%url
yy : copyurl
p : Open %clipboard
P : TabOpenNew %clipboard
o : Open -i
O : TabOpenNew -i
s : Open -i g
S : TabOpenNew -i g
b : Open -b
B : TabOpenNew -b
'' : BackToPageMark
&lt;C-^> : TabSwitchLast
&lt;C-ESC> : GoEmergencyMode
&lt;ESC> : Escape
&lt;C-[> : Escape
,z : ToggleImageSize
&lt;SPACE>tw : TabOpenNew http://www.twitter.com
&lt;SPACE>gr : TabOpenNew http://www.google.com/reader
&lt;SPACE>m : TabOpenNew https://mail.google.com/mail/#inbox
Insert Mode Mapping (imap)
&lt;ESC> : Escape
&lt;C-[> : Escape

Search/Command Mode Mapping (cmap)
&lt;TAB> : FocusNextCandidate
&lt;S-TAB> : FocusPrevCandidate
&lt;DOWN> : FocusNextCandidate
&lt;UP> : FocusPrevCandidate
&lt;ESC> : Escape
&lt;C-[> : Escape

Emergency Mode Mapping (emap)
&lt;ESC> : Escape

Command Aliases (alias)
o : Open
ot : TabOpenNew
opt : OpenOptionPage
help : TabOpenNew http://github.com/k2nr/ViChrome/wiki/Vichrome-User-Manual
map : NMap
tabe : TabOpenNew
tabnew : TabOpenNew
tabn : TabFocusNext
tabp : TabFocusPrev
tabN : TabFocusPrev
tabr : TabFocusFirst
tabl : TabFocusLast
tabc : TabCloseCurrent
tabo : TabCloseAll --only
tabs : TabList
q : TabCloseAll
copyurl : Copy %url
copytitle : Copy %title
viewsource : TabOpenNew --next view-source:%url
OpenNewTab : TabOpenNew
MoveToNextTab : TabFocusNext
MoveToPrevTab : TabFocusPrev
MoveToFirstTab : TabFocusFirst
MoveToLastTab : TabFocusLast
CloseCurTab : TabCloseCurrent
CloseAllTabs : TabCloseAll
ShowTabList : TabList
ReloadTab : TabReload
OpenNewWindow : WinOpenNew
ext : TabOpenNew chrome://extensions/
option : TabOpenNew chrome://settings/browser
downloads : TabOpenNew chrome://downloads
history : TabOpenNew chrome://history

※C -> Ctrlの意味
</pre>


<p>よく使うvimキーバインドがchromeの機能に置き換わってるのがわかると思います。 ※ちなみに左がコマンドで右がその動作ね。</p>

<p>僕が不便に感じた点は Ctrl + l のキーバインドです。 Chromeの場合、Ctrl + l はアドレスバーにフォーカスするショートカットキーですが、それが このプラグインで上書きされてしまいます・・・。（タブ移動のエイリアスになってる） gtとgTでタブ移動できるんだから変なエイリアス追加しないで欲しかった、というのが正直なきもちです。</p>

<p>一応、chromeのショートカットを変更することも、vichromeのキーバインドやエイリアスを変更することも 可能ではあるらしいのですが、僕がやってないので、紹介はしません。</p>

<h3>Eclipseでvimキーバインド</h3>

<hr />

<p>僕はデバッグはIDEを使い、コーディングにはvimまたはsublimetextを使う、というのが一番 慣れているんですが、sastrutsかplayを使ったお仕事のときにEclipseで構築したtomcatサーバで、 Eclipse以外で編集されたコードがあってもHot-deployが動作しない、ということがありました。 （ごめんないさい、原因も解決策もないですし、もしかしたら何か別の問題かも。ただvimで編集しても Hot-deployが動作しなかったことだけは確か）</p>

<p>仕方なくEclipseで作業することにしたんですが、マウス操作やカーソル移動が煩わしくプラグインを探しました <a href="http://vrapper.sourceforge.net/update-site/stable/">vrapper</a></p>

<p>こちらのプラグインはvichromeほど多機能ではありませんが、カーソル移動やウィンドウ制御に 関しては、vimと同様のものを提供しています。</p>

<p>ただ、煩わしいのはディレクトの移動ですね。これはvim以外の大多数のエディタに言えることですが 複数ファイルをサイドバーから選ぶ、なんていうときは大体マウス操作が必要になります。</p>

<p>いろんなファイルを開いておいてタブ移動、ならgt gTで問題ないんですが、急に関連のないファイルを 見たいときなんかは不便です。関連のあるクラスやファイルなんかは、僕はEclipseのショートカットである F3を利用しています。（定義に移動するショートカット）</p>

<h3>VisualStudio (2010)でvimキーバインド</h3>

<hr />

<p>こちらも理由としてはほとんどEclipseと一緒。最近のお仕事や個人の制作では利用することが少なく なったんですが、学校の課題でwindowsアプリケーションがあったので最近導入しました。</p>

<p>Eclipseがプラグインだらけで最近ものすっごくもっさりしてきたので、久しぶりに使ったら VisualStudioすごい快適に感じました。（バージョンは2010です）</p>

<p>導入しているプラグインはVsVim <a href="http://visualstudiogallery.msdn.microsoft.com/59ca71b3-a4a3-46ca-8fe1-0e90e3f79329/">VsVim</a></p>

<p>ついでなんですけど、VisualStudioもEclipseもテーマを配布していて、エディタの外観を自由に変更 できます。VisualStudioに対応したものを配布しているサイトを貼っておきます。 <a href="http://studiostyl.es/">studio style</a></p>

<h3>Sublimetext2でvimキーバインド</h3>

<hr />

<p>これはSublimetextを使ってて、vimに対応させた、というよりはvimキーバインドが標準で使えるから sublimetextを使ってみた、というのが僕の場合正しいです。</p>

<p>sublimetextには標準でvimキーバインドを有効にする設定が用意されています。 <a href="http://www.sublimetext.com/docs/2/vintage.html">sublimetext公式Document -vintage mode-</a></p>

<p>&#8220;ignored_packages&#8221;: [&ldquo;Vintage&rdquo;]を空にして、&#8221;vintage_start_in_command_mode&#8221;: true にするだけですね。</p>

<p>僕は加えてBlock Cursor Everywhere と vintageEX をvim系操作の強化として導入しています。</p>

<hr />

<p>なんかあんまり中身ない、ただプラグインの紹介で終わった気もするけど。こうやって見ると『だいたいの環境で』とかいいつつ、自分ブラウザとエディタとIDEくらいしか使ってないのかなー（笑）</p>

<p>無理矢理にでもvimの操作になれたい人は是非！Macの開発者向けアプリのdashも最近vimキーバインドをサポートしました。</p>

<p><a href="https://itunes.apple.com/jp/app/dash-docs-snippets/id458034879?mt=12">Dash -app store-</a></p>

<p>vimrcとgvimrcも特別な設定はしていませんが、公開しています。vimrcのほうには、よくつかうけど忘れるコマンドのメモとかも書いちゃってますｗ</p>

<p>これは別ファイルにしたほうがいいかもなー。<br/>
<a href="https://github.com/KentaKomai/MyConfigureFIles/blob/master/vimrc">vimrc -github-</a><br/>
<a href="https://github.com/KentaKomai/MyConfigureFIles/blob/master/gvimrc">gvimrc -github-</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/17/wordpress47/">Markdown投稿テストとちょっとした紹介</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-17T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ブログの投稿のフォーマットをMarkdownn + pretty syntax highloghterに変更しました。Githubやtracのドキュメントに利用されている、軽量マークアップ言語です。今まで必要に迫られたときに限ってGoogle検索しながら、ちまちまと書いていましたが、ちゃんと覚えたいので自鯖のwordpressにプラグインを入れました。</p>

<p><a href="http://ja.wikipedia.org/wiki/Markdown">markdown -wikipedia-</a></p>

<p>復習と動作確認のために、ひと通り文法を紹介したいと思います。</p>

<h2>●段落</h2>

<p>段落は空行を挿入するだけでわけられます。 (以下サンプル)</p>

<p>この段落は１つめの段落です。この段落は１つめの段落です。この段落は１つめの段落です。この段落は１つめの段落です。この段落は１つめの段落です。この段落は１つめの段落です。この段落は１つめの段落です。</p>

<p>この段落は２つめの段落です。この段落は２つめの段落です。この段落は２つめの段落です。この段落は２つめの段落です。この段落は２つめの段落です。この段落は２つめの段落です。この段落は２つめの段落です。</p>

<h2>●見出し</h2>

<p>HTMLタグでいうh1やh2のように、見出しを表示したいときに利用します。<br/>
(以下サンプル)</p>

<h1>A</h1>

<h2>B</h2>

<h3>C</h3>

<h4>D</h4>

<h5>E</h5>

<pre># A  
## B  
### C  
#### D  
##### E

</pre>


<h1>H1TITLE</h1>

<h2>H2TITLE</h2>

<pre>//h1とh2は以下のようにしても表現できます。
//個人的には、こちらのほうがマークアップしたときに見やすいのでおすすめ
H1TITLE
=======
H2TITLE
-------
</pre>


<h2>●テキストの強調</h2>

<p>文章中に強調して表示したい箇所に利用します。 （以下サンプル）</p>

<p>僕はカメラが<em>大好き</em>です</p>

<p>僕は佐々木希が<strong>大好き</strong>です</p>

<p>わかりづらいですが、カメラのほうは「大好き」が斜体で表示されています。 強調にも二段階あって、斜体->太字、というようになっています。</p>

<pre>僕はカメラが_大好き_です

僕は佐々木希が__大好き__です
</pre>


<h2>リスト</h2>

<p>リストにはHTMLと同じく、インデックス有りと無しの二種類があります。</p>

<ul>
<li>C言語</li>
<li>Java</li>
<li>Ruby</li>
<li>Python</li>
<li>Javascript

<ul>
<li>Coffee script</li>
<li>Type Script</li>
</ul>
</li>
</ul>


<pre>* C言語
* Java
* Ruby
* Python
* Javascript
    * Coffee script
    * Type Script
//子要素を配置したいときは、４つのスペース、またはインデントで可能
</pre>


<ol>
<li>Facebook</li>
<li>twitter</li>
<li>Google+</li>
<li>mixi</li>
</ol>


<pre>1. Facebook
2. twitter
3. Google+
4. mixi
</pre>


<h2>引用</h2>

<p>どこか他の場所から文章を引用したときなんかに利用します。 (以下サンプル)</p>

<blockquote><p>&#8220;本機はPlayStation 3 (PS3) の次世代機となる、第8世代に属する家庭用ゲーム機である。 この開発にあたっては、性能向上と引き換えにソフト開発を困難にさせていた[2][3]前世代機のPS3から一転、ゲーム開発者の力を活かすことが最優先とされた<a href="http://codedehitokoto.blogspot.jp/2012/04/sublimetext2markdown.html">4</a>。メインプロセッサーには、PS2のEmotion Engine、PS3のCellと、新開発のCPUを採用していたこれまでの流れから変わって、本機では既成CPUのカスタム品が用いられている。そのアーキテクチャーには、PCにおいて一般的に使用され普及している事から、開発者にとって親和性が高いx86-64が採用され、開発を比較的容易にしているとされる[5]。&#8221;</p></blockquote>

<p>これはwikipediaからplaystation4の記事を引用した例です。</p>

<pre>>"本機はPlayStation 3 (PS3) の次世代機となる、第8世代に属する家庭用ゲーム機である。
この開発にあたっては、性能向上と引き換えにソフト開発を困難にさせていた[2][3]前世代機のPS3から一転、ゲーム開発者の力を活かすことが最優先とされた[4]。メインプロセッサーには、PS2のEmotion Engine、PS3のCellと、新開発のCPUを採用していたこれまでの流れから変わって、本機では既成CPUのカスタム品が用いられている。そのアーキテクチャーには、PCにおいて一般的に使用され普及している事から、開発者にとって親和性が高いx86-64が採用され、開発を比較的容易にしているとされる[5]。"
</pre>


<h2>リンク</h2>

<p>文章中にハイパーリンクを挿入したいときに利用します。これにはいくつかの記法がありますが、一番簡単なものをここでおさらいします。 (以下サンプル)</p>

<p><a href="http://ja.wikipedia.org/wiki/X86">x86 -wikipedia-</a> <a href="http://ja.wikipedia.org/wiki/ARM%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3">ARMアーキテクチャ -wikipedia-</a></p>

<pre>/*
 * []内がリンクテキスト
 * ()内がURL
 */
[x86 -wikipedia-](http://ja.wikipedia.org/wiki/X86)
[ARMアーキテクチャ -wikipedia-](http://ja.wikipedia.org/wiki/ARM%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3)
</pre>


<h2>水平線</h2>

<p>文章中に水平線を挿入します。</p>

<blockquote><p>&#8220;1行の中に、3つ以上のハイフンやアスタリスク・アンダースコアだけを並べると水平線が作られる。ハイフンやアスタリスクのあいだには空白を入れてもよい。以下の行はすべて水平線を生成する:&#8221;</p></blockquote>

<p>ということらしいです。(以下サンプル)</p>

<hr />

<hr />

<hr />

<hr />

<p>４つの水平線が表示されていますね。</p>

<pre>-------------------

- - - - - - - - - -

****

* * * * *
</pre>


<h2>最後に僕の課題</h2>

<p>ひと通り基本的な文法を押さえたうえでWordpressに内蔵されているエディタで書いてみたんですが、とにかく<strong>面倒くさい！！</strong></p>

<p>WEBフォーム上で、Markdown記法でブログを書くのは、ちょっと骨が折れますね・・・</p>

<p>原因として考えられるのは以下</p>

<ol>
<li>インデントがTabキーでできない</li>
<li>表示領域が限られている(Markdownに限ったことではないですが)</li>
<li>リンクの挿入したいときに、[]や()などを書くのが面倒くさい(コーディングに利用しているエディタとくらべて、という意味で)</li>
<li>まだ考える前にタイピングできるほどMarkdownの記法が馴染んでない。</li>
</ol>


<p>ということだと思います。</p>

<p>ここで考えたのが、いつもコーディングに利用しているSublimetext2を使い、Markdownでブログ記事を記述。それをWordpressでインポートすれば、問題が解決できるのではないか、と思いました。</p>

<p>プラグインを探してみたらすぐに見つかりました。</p>

<p><a href="http://codedehitokoto.blogspot.jp/2012/04/sublimetext2markdown.html">sublimetext markdown preview</a></p>

<p>これを利用してみます。インストール方法などは記事がいくつもあるので参照してみてください。</p>

<p>デフォルトのキーバインドはcommand + option + o(英小文字のオー)らしいのですが、僕は既存のキーバインドと衝突があるので、alt + m　に変更しました。(変更はkey Binding の Userで)</p>

<p><a href="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/Screen-Shot-2013-06-17-at-11.44.11.png" rel="image_group"><img src="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/Screen-Shot-2013-06-17-at-11.44.11.png?resize=955%2C331" alt="Screen Shot 2013-06-17 at 11.44.11" class="alignnone size-large wp-image-588" data-recalc-dims="1" /></a></p>

<p>こんな感じでマークアップしたものを alt + m　を押すことで、ブラウザが起動し、</p>

<p><a href="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/Screen-Shot-2013-06-17-at-11.45.04.png" rel="image_group"><img src="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/Screen-Shot-2013-06-17-at-11.45.04.png?resize=955%2C396" alt="Screen Shot 2013-06-17 at 11.45.04" class="alignnone size-large wp-image-589" data-recalc-dims="1" /></a></p>

<p>このようにプレビューが表示されます。ブログも使い慣れているエディタで書けるようになりました。 ばっちり！！</p>

<p>GithubのREADME.mdは全てこの機能を内包し、少しの独自機能が加わったものです。わからない書き方があれば、GithubにあるREADME.mdのソースを見るのもいいと思います。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/13/wordpress46/">『新版暗号技術入門――秘密の国のアリス』読み終わりました</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-13T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>レビューっていう程のものじゃなく</p>

<p>・購入を検討してる人への参考になれば。</p>

<p>・自分が読んで印象に残ったところを記録しておくため</p>

<p><a href="http://www.hyuki.com/cr/">http://www.hyuki.com/cr/</a></p>

<p><a href="http://www.amazon.co.jp/%E6%96%B0%E7%89%88%E6%9A%97%E5%8F%B7%E6%8A%80%E8%A1%93%E5%85%A5%E9%96%80-%E7%A7%98%E5%AF%86%E3%81%AE%E5%9B%BD%E3%81%AE%E3%82%A2%E3%83%AA%E3%82%B9-%E7%B5%90%E5%9F%8E-%E6%B5%A9/dp/4797350997/ref=dp_ob_title_bk">http://www.amazon.co.jp/%E6%96%B0%E7%89%88%E6%9A%97%E5%8F%B7%E6%8A%80%E8%A1%93%E5%85%A5%E9%96%80-%E7%A7%98%E5%AF%86%E3%81%AE%E5%9B%BD%E3%81%AE%E3%82%A2%E3%83%AA%E3%82%B9-%E7%B5%90%E5%9F%8E-%E6%B5%A9/dp/4797350997/ref=dp_ob_title_bk</a></p>

<p>&nbsp;</p>

<p>という２点から、これから読み終わった本に関してちょっと書こうと思います。</p>

<p>&nbsp;</p>

<p>１．読み始めたきっかけ</p>

<p>最初は学校の友人が購入したけど、読む時間がない、ってことだったから借りました。</p>

<p>借りたはいいけど、結局僕もまとまった時間を取れずに、冒頭を少し読んでそのままでした。</p>

<p>ですが、最近になって講義で暗号学の基礎を取り上げたものを受講したので、講義でやるなら予習したいなー、というつもりで再び読み始めました。</p>

<p>&nbsp;</p>

<p>２．読むのにかかった時間</p>

<p>ちゃんとした時間を測ったわけではないですが、５月初旬から登下校中の電車で、平日読んで、まぁ４週間くらいだったと思います。</p>

<p>（※若干ざっくりとだけ読んだ場所もあったかも）</p>

<p>&nbsp;</p>

<p>３．構成（順番は本書とは違います、括弧内は解説されている技術）</p>

<ol>
<li>暗号の歴史（シーザー暗号、単一換字式暗号、エニグマ）</li>
<li>共通鍵暗号方式に関して(one-time-pad, DES , 3DES, AES)</li>
<li>公開鍵暗号方式に関して(RSA)</li>
<li>ブロック暗号のモード(ECB, CBC, CFB, OFB, CTR)</li>
<li>ハイブリット暗号</li>
<li>ハッシュ関数(md5, sha-1, sha-2)</li>
<li>メッセージ認証 / デジタル署名</li>
<li>デジタル証明書</li>
<li>暗号における鍵</li>
<li>乱数</li>
<li>実際に暗号が使われてる技術(PGP、 SSL/TSL)</li>
<li>暗号技術と現実世界</li>
</ol>


<p>上記の1 &#8211; 4で暗号に使われている基礎的な技術を解説。</p>

<p>5-8に1-4の技術を組み合わせたものを解説</p>

<p>9-10で暗号を支える基礎技術の解説</p>

<p>11で実用例</p>

<p>12では総括と暗号技術をリテラシーに絡めた内容になってます。</p>

<p>&nbsp;</p>

<p>４．読んでみて</p>

<p>まず、全体を通して</p>

<p>・技術が発明された経緯（例：公開鍵暗号方式が発明された経緯）</p>

<p>・技術解説（例：DESの仕組み[鍵長やアルゴリズムなど]）</p>

<p>・この技術の問題点の提示（例：鍵配送問題）</p>

<p>・攻撃例（例：ブルートフォースアタック、鍵の漏洩）</p>

<p>・知識確認のための問題と解答・解説</p>

<p>&nbsp;</p>

<p>という流れで構成されています。</p>

<p>僕の感想として</p>

<p>・歴史的な背景や問題解決の手段として、新たな暗号技術が発明された背景が順を追って解説されている</p>

<p>・アルゴリズムや技術的な解説だけでなく、その技術の問題点の提示がされている（次に解説される技術の背景に繋がる）</p>

<p>・それを逆手にとった攻撃手法も紹介している</p>

<p>・最後にまとめとしてシンプルな演習問題と解説が載っている</p>

<p>以上の点から、理解がしやすく</p>

<p>『暗号技術を学ぶ』ための技術書、というよりは</p>

<p>小学校のときに読んだ歴史の漫画のように一連の物語のような感覚で読めました。</p>

<p>&nbsp;</p>

<p>用語は知っていたけど、実際細かいところはわからなかった自分としては、とても重宝しました。</p>

<p>ざっくりと、できるだけ早く読みたい、という方には、上記の構成のうち(2,3,4,5,6,7,8, TSL/SSL, 12)だけ読むのもいいと思います。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/10/wordpress45/">[Python]たまに使うけど、忘れるとめんどくさいやつ色々</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-10T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>自分用メモ以外の何者でもないですが。</p>

<p>&nbsp;</p>

<pre class="lang:python decode:true crayon-selected"># -*- coding:utf-8 -*-

import sys
import pprint

def main():
    print("--- python Interpreter version ---")
    interpreter_version_detail = sys.version        # バージョン情報詳細を文字列で
    interpreter_version_list = sys.version_info     # バージョン情報をオブジェクトで

    print(interpreter_version_detail)
    print("major:" + str(interpreter_version_list.major) )
    print("minor:" + str(interpreter_version_list.minor) )
    print("releaselevel:" + str(interpreter_version_list.releaselevel) )
    print("serial:" + str(interpreter_version_list.serial) )

    #type()メソッド : オブジェクトの種類を出力
    print( type("a") )
    print( type([1,2]) )
    print( type((1,2)) )
    print( type({'a':1, 'b':2}) )

    # is演算子と==演算子は別物
    print( 1 == True ) # ==は同値かどうか(PythonにおけるTrueは１) True
    print( 1 is True ) # isは同一オブジェクトかどうか False
    a = [1]
    b = [1]
    print( a is b ) # False (インスタンスが別)
    print( a == b ) # True (値が一緒)
    a = b
    print( a is b ) # True (インスタンスも一緒)
    print( a == b ) # True (値が一緒)

    #printの自動改行をしない
    print "hogehoge",           # for python 2.x 後ろにコンマをつける
    print("hogehoge", end='')   # for python 3.x 引数endに空文字を指定する

    #phpのvar_dump()的なことがしたいとき
    a = {'a':1, 'b':2, 'c':3}
    pprint.pprint(a)    #でもvar_dump()ほど使いやすくはない

    # 進数相互変換
    print( format(10, 'b') )    # decimal-&gt;bin  1010
    print( bin(10) )            # decimal-&gt;bin  0b1010

    print( format(10, 'x') )    # decimal-&gt;hex  a
    print( hex(10) )            # decimal-&gt;hex  0xa

    print( chr(65) )            # decimal-&gt;ascii a
    print( ord('A') )           # ascii-&gt;decimal 65

    print( int('a', 16) )       # hex-&gt;decimal   10
    print( int('10', 2) )       # bin-&gt;decimal   2

if __name__ == '__main__':
    main()</pre>


<p>&nbsp;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/10/wordpress44/">仕事中や作業の合間についついSNS見て集中できない人へ</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-10T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>すいません、僕です。</p>

<p>そんな愚かな僕の僕による、僕のためのスクリプトを制作。</p>

<p>&nbsp;</p>

<p>目的</p>

<p>任意のタイミングでスクリプトを実行すると</p>

<p>・twitter</p>

<p>・facebook</p>

<p>・ニコニコ動画</p>

<p>・youtube</p>

<p>・hulu</p>

<p>などなどにアクセスできなくなる、ようにするだけスクリプト。</p>

<p>とそれを解除する仕組みも一緒に。</p>

<p>&nbsp;</p>

<p>これでいいですかね。</p>

<p>python3系じゃないと動きません。</p>

<p>hostsファイルに対象ドメインつっこんで、アクセスできなくするだけ。</p>

<p>offが指定されたら、対象箇所をカットする。</p>

<p>思いついたときは、楽しくなってきたｗｗｗｗｗｗってなってたけど、完成したらどこか悲壮感を感じた。</p>

<pre class="lang:python decode:true"># -*- coding:utf-8 -*-
import sys
import os

HIDDENDOMAIN = []
HIDDENDOMAIN.append("twitter.com")
HIDDENDOMAIN.append("www.facebook.com")
HIDDENDOMAIN.append("mixi.jp")
HIDDENDOMAIN.append("www.youtube.com")
HIDDENDOMAIN.append("www.nicovideo.jp")
HIDDENDOMAIN.append("www.pixiv.net")
HIDDENDOMAIN.append("www.feedly.com")
HIDDENDOMAIN.append("www.hulu.jp")

HIDDEN_START_INDEX = "### お仕事モード ON ここから ##\n"
HIDDEN_END_INDEX = "### お仕事モード ON ここまで ###\n"

HOSTS_FILEPATH = "/private/etc/hosts"

def mode_check(argvs):

    error_flag = False
    if len(argvs) != 2:
        error_flag = True

    elif argvs[1] != 'on' and argvs[1] != 'off':
        error_flag = True

    if error_flag:
        print("&lt;usage&gt;: " + argvs[0] + " [on / off]")
        exit()

    mode = argvs[1]
    return mode

def main():
    mode = mode_check(sys.argv)
    print(mode)

    string_buffer = []
    with open(HOSTS_FILEPATH, encoding='utf-8') as file_read_stream:
        index_flag = True
        for line in file_read_stream:
            print(line, end='')
            if line == HIDDEN_START_INDEX:
                index_flag = False

            elif index_flag:
                string_buffer.append(line)

            elif line == HIDDEN_END_INDEX:
                index_flag = True

    with open(HOSTS_FILEPATH, mode='w', encoding='utf-8') as file_write_stream:
        for line in string_buffer:
            file_write_stream.write(line)

        if mode == 'on':
            print('working mode on')
            file_write_stream.write(HIDDEN_START_INDEX)

            for domain in HIDDENDOMAIN:
                file_write_stream.write("127.0.0.1\t" + domain + "\n")

            file_write_stream.write(HIDDEN_END_INDEX)
            print("Complete! Good luck your work!")

        else:
            print('working mode off')

if __name__ == "__main__":
    main()</pre>


<p>hostsファイルへのパスは各自の環境で、ドメインも好きなものを追加してください。</p>

<p>実行するときはsudo忘れずに。</p>

<p>&nbsp;</p>

<blockquote><p>sudo python3 script.py [on/off]</p></blockquote>

<p>&nbsp;</p>

<p><a href="https://github.com/KentaKomai/warehouse/blob/master/work_switch/workswitch.py">https://github.com/KentaKomai/warehouse/blob/master/work_switch/workswitch.py</a></p>

<p>&nbsp;</p>

<p>&nbsp;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/07/wordpress43/">MacOSなどでコマンドラインからキーボードでEOFを入力する方法</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-07T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ひさしぶりにAOJやってて、EOFまで文字列を読み込む処理があって</p>

<p>手元でテストするときに困ったのでメモ。</p>

<p>わざわざブログ書くほどのことでもないけど</p>

<blockquote><p>control + d</p></blockquote>

<p>を押すことでEOF（End of Fileという入力やファイルの最終端を意味する文字）をキーボードから入力できます。</p>

<p>&nbsp;</p>

<p>余談ですが、AOJではこちらの問題やりました。</p>

<p>僕もアルゴリズムの勉強やプロコンなど始めたばかりですが、いい問題だと思ったので、ついでに書いておきます。</p>

<p><a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0026">http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0026</a></p>

<p>&nbsp;</p>

<p>いつもプロコンに参加してる人には簡単な問題だと思いますが、プロコンってなに！？って人には是非チェックしてほしいな、と思った問題でした。</p>

<p>（基本的な制御文がひと通り出てくるのと、難しいアルゴリズムは必要ないので。）</p>

<p>&nbsp;</p>

<pre class="lang:default decode:true">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;

using namespace std;

#define XAXIS 10
#define YAXIS 10

int main(){
    int paper[XAXIS][YAXIS];
    int x,y,s;
    int white = 0, most=0;

    for(int i=0; i&lt;XAXIS; i++)
    for(int j=0; j&lt;YAXIS; j++)
        paper[i][j] = 0;

    while(scanf("%d,%d,%d", &x, &y, &s) != EOF){
        switch(s){
            case 3:
                if(x+2 &lt;  XAXIS) paper[x+2][y] += 1;
                if(y+2 &lt;  YAXIS) paper[x][y+2] += 1;
                if(x-2 &gt;= 0)     paper[x-2][y] += 1;
                if(y-2 &gt;= 0)     paper[x][y-2] += 1;

            case 2:
                if(x+1 &lt;  XAXIS && y+1 &lt; YAXIS )  paper[x+1][y+1] += 1;
                if(x+1 &lt;  XAXIS && y-1 &gt;= 0)       paper[x+1][y-1] += 1;
                if(x-1 &gt;= 0     && y+1 &lt; YAXIS )  paper[x-1][y+1] += 1;
                if(x-1 &gt;= 0     && y-1 &gt;= 0)       paper[x-1][y-1] += 1;

            case 1:
                if(x+1 &lt;  XAXIS) paper[x+1][y] += 1;
                if(y+1 &lt;  YAXIS) paper[x][y+1] += 1;
                if(x-1 &gt;= 0)     paper[x-1][y] += 1;
                if(y-1 &gt;= 0)     paper[x][y-1] += 1;
                paper[x][y] += 1;
                break;
        }
    }

    for(int i=0; i&lt;XAXIS; i++)
    for(int j=0; j&lt;YAXIS; j++){
        if(paper[i][j] == 0 )  white++;
        most = max(most,paper[i][j]);
    }

    cout&lt;&lt;white&lt;&lt;endl&lt;&lt;most&lt;&lt;endl;
    return 0;
}</pre>


<p>僕はこんな感じでAcceptでしたが、switch文の内部のif文はどうにかしたいなぁ・・・。</p>

<p>他の人のソースコードを見ることもできます。</p>

<p>ランキング高い人は、大体最初にxとyに+2してる感じですね。</p>

<p>こっちの話のほうが長くなっちゃった・・・。</p>

<p>&nbsp;</p>

<p>とりあえず今まで知らなかった controll + d が便利！！！</p>

<p>すいません、それがメインです。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/06/wordpress42/">[C言語]casehack.cワロタｗｗｗ</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-06T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>twitterのTLに流れてきたリンク</p>

<p><a href="http://pastebin.com/EY3WQNzC">http://pastebin.com/EY3WQNzC</a></p>

<p>casehack.cではswitch-case文の面白い手法を紹介している。</p>

<pre class="lang:c decode:true">#include &lt;stdio.h&gt;

int main() {
    int i=5;
    switch ( 2 ) {
        case 0:
            for (  i=0; i&lt;10; i++ ) {
        case 1:
            printf("A i=%d\n",i);
        case 2:
            printf("B i*i=%d\n",i*i);
            };
        case 3:
            printf("done");
            break;
    }

    return 0;
}</pre>


<p>上記のサンプルコードをコンパイルし、実行すると</p>

<pre class="lang:c decode:true">/* OUTPUT
B i*i=25
A i=6
B i*i=36
A i=7
B i*i=49
A i=8
B i*i=64
A i=9
B i*i=81
done
*/</pre>


<p>こちらが出力される、というもの。</p>

<p>ちょっと意味がわからないｗｗｗ</p>

<p>&nbsp;</p>

<pre class="lang:c decode:true">#include &lt;stdio.h&gt;

int main() {
    int i=5;
    switch ( 2 ) {
        case 0:
        printf("befor for\n");
            for (  i=0; i&lt;10; i++ ) {
        printf("%d\n", i);
        case 1:
            printf("A i=%d\n",i);
        case 2:
            printf("B i*i=%d\n",i*i);
            };
        case 3:
            printf("done");
            break;
    }

    return 0;
}</pre>


<p>流れを追っかけるためにprintfをcase:0の処理に注入。</p>

<p>この状態で実行する</p>

<pre class="lang:c decode:true">B i*i=25
6
A i=6
B i*i=36
7
A i=7
B i*i=49
8
A i=8
B i*i=64
9
A i=9
B i*i=81
done</pre>


<p>これが出力されました。</p>

<p>case 0: 内部の１行目のコードが実行されていないことがわかります。</p>

<p>以下が流れ</p>

<p>１．switch(2)なので case 2:のブロックが実行される</p>

<pre>printf("B i*i=%d\n",i*i)</pre>


<p>２．case 2:の最後にある } (中括弧)に対応しているfor文の頭に戻る。</p>

<pre>for (  i=0; i&lt;10; i++ ) {</pre>


<p>３．switch-case文に入る前から i は5なので、あとはそのままi++されながら10になるまでループ</p>

<p>これによって、</p>

<pre>for (  i=0; i&lt;10; i++ ) {
        printf("%d\n", i);
        case 1:
            printf("A i=%d\n",i);
        case 2:
            printf("B i*i=%d\n",i*i);
            };</pre>


<p>この箇所が４回繰り返される。</p>

<p>&nbsp;</p>

<p>goto文のスコープを限定した局所的なものが、switch-case文って感じなのかな？？</p>

<p>これ使い道があるかは別として、面白かったので手元で再現してみました。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/03/wordpress41/">コールバック関数に関して調べる</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-03T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今まで何の気も無しに、なんとなく使っていたコールバック関数(jQueryのajax()とか)ですが、Windowsアプリケーションの解析とかちょっとやってみたら頻繁に出てきて、ちゃんと仕組みを知りたいな、と思って調べました。</p>

<p>&nbsp;</p>

<p>調べるきっかけになったのは</p>

<p>1.windowsアプリのイベントドリブンの仕組みを調べる</p>

<p>2.ウィンドウプロシージャの仕組みを調べる</p>

<p>3.コールバック関数とは何か、ということを調べる</p>

<p>&nbsp;</p>

<p>といった流れです。windowsアプリ以外にもプログラミングで日常的に利用されているので、これを機会にざっくり調べてまとめます。（もしちゃんと調べたい人には役に立たない落書きになるかもしれませんが。）</p>

<p>&nbsp;</p>

<p><a href="http://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E9%96%A2%E6%95%B0">コールバック(wikipedia)</a></p>

<p>そもそもコールバックとはなんぞ</p>

<blockquote><p>プログラム中で、呼び出し先の関数の実行中に実行されるように、あらかじめ指定しておく関数。</p>

<p>呼び出し先の関数の引数としてコールバック関数への参照情報を渡すことで、呼び出し先から任意のコールバック関数を実行させ、コールバック関数に実行制御を移すことができる。</p></blockquote>

<p>コールバック（関数）という名前の由来ですが、これは、</p>

<blockquote><p>電話を相手に一度かけて電話番号のみを伝え、いったん電話を切って折り返し相手からかけなおしてもらう様子(これを「コールバック」という)に似ているためこの名前がついた。</p>

<p>（<a href="http://e-words.jp/w/E382B3E383BCE383ABE38390E38383E382AFE996A2E695B0.html">引用元</a>）</p></blockquote>

<p>だそうです。正直ピンと来ない・・・。</p>

<p>多分、要約すると</p>

<p>自分（プログラマ）が呼び出した関数の内部で、呼び出す関数を指定できて、それをコールバック関数と呼ぶ。システムやライブラリの関数は指定されたコールバック関数を自分から呼ぶ、という感じだと思います。</p>

<p>&nbsp;</p>

<p>wikipediaにあったサンプルを実際に読んで動かしてみたいと思います。</p>

<pre class="lang:default decode:true ">int i;
 for (i = 0; i &lt; length; i++) {
     if (array[i] &gt; 5) { 
         break;
     }
 }

 if (i &lt; length) {
     printf("Item %d\n", i);
 } else {
     printf("Not found\n");
 }</pre>


<p>これがまずは、単純なコールバックを利用しないサンプル。array[]配列に5以上のものがあればbreakして、何番目の要素かを出力する、という処理。シンプルです。</p>

<p>ただしwikipediaでは上記のサンプルの問題点として</p>

<p>１．チェックするべき配列が増える度にfor文が増えること</p>

<p>２．非同期で処理が行われていた場合に、array[]の中身を順番に、ではなく飛ばしてしまったり、最悪辿ることができなくなる（おそらく他のスレッドからarray[]に対する挿入や削除、編集があったときなど）</p>

<p>という点をあげています。</p>

<p>ここでwikipediaから引用</p>

<blockquote><p>代替手法として、新たに<a href="http://ja.wikipedia.org/wiki/%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA" title="ライブラリ">ライブラリ</a>関数を作り、適当な<a href="http://ja.wikipedia.org/wiki/%E5%90%8C%E6%9C%9F_(%E8%A8%88%E7%AE%97%E6%A9%9F%E7%A7%91%E5%AD%A6)" title="同期 (計算機科学)">同期</a>を施して必要な処理を行うようにする。この手法でもリストを辿る必要が生じる度に同様の関数を呼び出す必要がある。この方式は様々なアプリケーションで使われる汎用ライブラリにはふさわしくない。ライブラリ開発ではあらゆるアプリケーションのニーズを予測することはできないし、アプリケーション開発ではライブラリの実装の詳細を知る必要がないのが望ましい。</p>

<p>コールバックが、この問題の解決策となる。リストを辿るプロシージャを書くとき、そのプロシージャがアプリケーションが各要素についての処理を行うコードを提供するようにする。これにより、柔軟性を損なわずに明確にライブラリとアプリケーションを区別することができる。</p>

<p>コールバックは実行時<a href="http://ja.wikipedia.org/wiki/%E6%9D%9F%E7%B8%9B_(%E6%83%85%E5%A0%B1%E5%B7%A5%E5%AD%A6)" title="束縛 (情報工学)">束縛</a>の一種と見ることもできる。</p></blockquote>

<p>つまり、配列チェックを関数化して、その中で配列の中身を同期しつつ、チェックすれば一応問題は解決するんだけど、それだと関数呼び出しが複数回行われるだけで、内部の処理は書きなおす必要がある。（ループと５以上の数字を判定するロジック）あんあり良い感じじゃない。</p>

<p>これらの問題点に対するコールバックを利用したサンプルとして挙げられているのが以下</p>

<pre class="lang:default decode:true">/* ライブラリコード */
 int traverseWith(int array[], size_t length, 
                  int (*callback)(int index, int item, void *param), 
                  void *param)
 {
     int exitCode = 0;
     for (int i = 0; i &lt; length; i++) {
         exitCode = callback(i, array[i], param);
         if (exitCode) { 
             break;
         }
     }
     return exitCode;
 }

 /* アプリケーションコード */
 int search (int index, int item, void *param)
 {
     if (item &gt; 5) {
         *(int *)param = index;
         return 1;
     } else {
         return 0;
     }
 }

 /* ライブラリを呼び出す本体 */
 int index;
 int found;
 found = traverseWith(array, length, search, &index);
 if (found) {
     printf("Item %d\n", index);
 } else {
     printf("Not found\n");
 }</pre>


<p>3o行目のtraverseWith()関数呼び出しで、引数に</p>

<p>１．array  :チェックする配列</p>

<p>２．length :配列のサイズ</p>

<p>３．search: search()関数のポインタ</p>

<p>４．&amp;index : 結果を格納するポインタ</p>

<p>を渡しています。</p>

<p>&nbsp;</p>

<p>traverseWith()関数内では</p>

<p>渡されたlengthの回数だけsearch()関数を呼び出し、結果を受け取り、受け取った結果がtrue(1)ならbreak;してます。</p>

<p>search()関数の引数には</p>

<p>・i : forループでインクリメントされるイテレータを渡す</p>

<p>・array[i] :　イテレータが指す配列内の要素を渡す</p>

<p>・param : 結果を格納するポインタ</p>

<p>を渡しています。</p>

<p>&nbsp;</p>

<p>search()関数内では</p>

<p>渡されたarray[i]が５以上なら、イテレータ(i)をparamに格納して、１(true)を返しています。</p>

<p>５未満なら０を返すのみ。</p>

<p>&nbsp;</p>

<p>これで処理は30行目に戻ってきて、５以上の値がarray[]にあれば、そのイテレータを出力する、という前述したサンプルと同様の動作を行なっています。</p>

<p>&nbsp;</p>

<p>これによって、判定の箇所を抜き出して、アルゴリズムに自前のコードを渡すことが可能になってます。</p>

<p>コールバックが定義され、利用されるようになった流れは上記のサンプルから説明ができます。</p>

<p>&nbsp;</p>

<p>目的</p>

<p>リストから５以上の値を持った最初のイテレータを取得したい。</p>

<p>&nbsp;</p>

<p>手段</p>

<p>１．for文を用いて、内部で数値を判定。５以上の数値を発見する</p>

<p>問題点：チェックを行う度にforループと判定の処理を書く必要がある。非同期の処理が動いているときに、処理の内容が担保できない。</p>

<p>&nbsp;</p>

<p>２．配列の内容を同期する処理を含んだ関数を用意する</p>

<p>解決された問題：都度forループと判定を書く必要がなくなった</p>

<p>問題点：判定を変えたいとき、などにほとんど同じ内容の処理を書く必要が出てくる。（ライブラリ化するときに不便）</p>

<p>&nbsp;</p>

<p>３．コールバックを利用して、判定の部分を柔軟に変更できるようにする</p>

<p>解決された問題：判定のアルゴリズムを変えたいときは、そこだけをコールバック関数として渡せるように変更した</p>

<p>&nbsp;</p>

<p>wikipediaに書かれているサンプルでは、こういうこと、だと思います・・・。ある条件にマッチしたイテレータを返すというライブラリ関数に、「５以上の」という条件を判定する関数を与えることができるようになりました。もちろん他の条件を与えたい場合は、任意に変更した関数を渡すのみ。</p>

<p>これがコールバック関数の第一歩・・・・なのかな。（細かいこと考えずに覚えゲーしたほうがいい気がしてきた・・・ｗ）</p>

<p>一応熟読して、こういうものなのかな、っていうのはつかめたけど、なんか自信がないｗ</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/06/02/wordpress40/">Raspberry Piにkali Linux入れて動かしてみる（＋日本語キーボードレイアウト適用）</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-06-02T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>先日、ネトゲで知り合った友人（と言っても、もう何度も会ってるしお互いの家に遊びにいったりもしてますが）と秋葉原に新しくできた<a href="http://tabelog.com/tokyo/A1310/A131001/13145362/">野郎ラーメン</a>を食べに行きました。</p>

<p>ものすごい食べやすい二郎系ラーメンって感じで、量もちょうどいい感じ。（ザ・二郎系を食べたい人には物足りない？？）</p>

<p>&nbsp;</p>

<p>そこで久しぶりに千石電商に寄りました。本当はArduinoのWi-Fiモジュール買いに行ったんですが、入り口に『<a href="http://www.raspberrypi.org/">Raspberry Pi</a>あります』の貼り紙。</p>

<p>なんと！</p>

<p>実は、欲しくてネットで買おうか悩んでたところだったので、衝動買い。価格は4000円強（詳しい価格は忘れちゃいました・・・）ネットで買うのと大差なかったです。(Wi-Fiモジュールとかケースとかも一緒に買っちゃいましたが・・・)</p>

<p><a href="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/IMG_2083.jpg" rel="image_group"><img class="alignnone size-large wp-image-474" alt="IMG_2083" src="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/IMG_2083.jpg?resize=640%2C853" data-recalc-dims="1" /></a></p>

<p>&nbsp;</p>

<p>付属ケースから取り出して別売りケースに入れている状態です。</p>

<p>ウキウキして購入したはいいものの、流行ってるから触ってみたい、というだけで何か特定の用途を考えていたわけではありませんでした。</p>

<p>うーん・・・何にしよう。</p>

<p>&nbsp;</p>

<p>そこで思い出したのが、ペネトレーションテストに特化したUbuntuベースのLinuxディストリビューション<a href="http://www.kali.org/downloads/">Kali Linux</a>でした。</p>

<p>RaspberryPi用のイメージファイルを配布してみます。これをインストールして、動かしてみようと思います。</p>

<p>※ただ、個人的にはLinuxがRaspberryPiで動作しても、これまた用途がないので、せっかくI/Oがついてたり、Arduinoの無線LANモジュール買ったりしたので、ハードウェアを動かすような、何かを作りたいなぁ、とか考えてます(ハードをいじったこと、ほとんどないですが笑</p>

<p>&nbsp;</p>

<p>１．Kali Linux公式ページからイメージファイルをダウンロードします</p>

<p><a href="http://www.kali.org/downloads/">http://www.kali.org/downloads/</a></p>

<p>このページにある Kali Linux for RaspberryPi をダウンロードすればOKです。</p>

<p>&nbsp;</p>

<p>２．win32 disk imagerをダウンロードしてインストール</p>

<p><a href="http://sourceforge.jp/projects/sfnet_win32diskimager/">http://sourceforge.jp/projects/sfnet_win32diskimager/</a></p>

<p>windows用のフリーソフトで、ディスクイメージファイルをUSBやSDカードに最適化してコピーしてくれます。</p>

<p>MacやLinuxはddコマンドなどで適切にマウントしてやる必要がありますが、それは別途記事にします。</p>

<p>&nbsp;</p>

<p>３．空のSDカードを用意する。（最低８GB）</p>

<p>公式ホームページでは容量８G以上、速度がclass10以上となってます。僕はそのまま8GB class10のSDカードを利用しました。</p>

<p>&nbsp;</p>

<p>４．SDカードにディスクイメージをマウントする。</p>

<p>win32 disk imagerを使って、１でダウンロードしたimgファイルを選択。書き込み先を空のSDカードにして writeボタンを押すだけです。</p>

<p>これが終わればSDカードの準備はOK。</p>

<p>&nbsp;</p>

<p>５．RaspberryPiを起動する</p>

<p>SDカードを差し込み、USBキーボードとHDMIケーブルを接続すれば最低限OKです。システムアップデートなどをすぐに行う場合は、LANケーブルも挿してください。準備ができたらmicroUSBを挿せば電源が入ります。</p>

<p>（※注意：システムをシャットダウンしたい場合はhaltコマンドを利用するのが無難です。一度知らずに起動したままmicroUSBを引っこ抜いたら起動しなくなりました）</p>

<p>正常に起動すると下記のような画面がディスプレイに表示されると思います。</p>

<p><a href="http://i1.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/IMG_2084.jpg" rel="image_group"><img class="alignnone size-large wp-image-477" alt="IMG_2084" src="http://i1.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/06/IMG_2084.jpg?resize=640%2C480" data-recalc-dims="1" /></a></p>

<p>&nbsp;</p>

<p>６．インストールしてすぐに行ったこと一覧</p>

<p>・# apt-get -y update</p>

<p>⇨パッケージ管理の情報をアップデート</p>

<p>・# apt-get -y upgrade</p>

<p>⇨パッケージを全て更新</p>

<p>・# dpkg-reconfigure locales</p>

<p>⇨ロケールを日本に変更</p>

<p>・# dpkg-reconfigure tzdata</p>

<p>⇨標準時刻を日本に設定</p>

<p>・# dpkg-reconfigure keyboard-configuration</p>

<p>⇨キーボードレイアウトを日本語キーボードに変更</p>

<p>・# dpkg-reconfigure console-data</p>

<p>⇨コンソールを日本語キーボードレイアウトに対応</p>

<p>・# vim .bashrcにexport LANG = Cを追加</p>

<p>⇨表示は英語のままロケールは日本にしたいので、表示言語だけ変更</p>

<p>&nbsp;</p>

<p>なんか効率的な方法他にありそうだけど、とりあえずこれで自分のやりたいように表示するところまでうまくいきました。</p>

<p>&nbsp;</p>

<p>※動かしてみた感想</p>

<p>CUIだとキビキビ動きますが、X起動すると、当然だけど重い。そしてナビゲーションバーが表示されないことが多々あるため、アプリケーション起動を行えないことが多い。</p>

<p>X起動なしCUIで当面使おう、と思ったが、msconsoleとか実行するとまた止まる。確かにkali LinuxがRaspberryPi上で動作することは確認できたけど、現状では、普通に全機能を利用する、という部分は難しそうだな、と感じました。でもCPU:700MHz、MEM:512MBでここまで動くんだから驚きました。</p>

<p>友人はメディアサーバとして利用していて、FullHD再生も問題なくできるそうです。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2013/05/29/wordpress39/">[Ruby Python]正規表現に関しておさらい</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2013-05-29T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>正規表現ってかなり頻繁に使うのに、なかなか一発で書けなくて、その度に調べてる気がするので、ここでちょっとまとめてみようと思いました。</p>

<p>個人的に最近よく利用するRubyとPythonでやってみようかな、と思ってます。</p>

<p>pythonに関しては公式で正規表現のサンプルがのったリファレンスがあったのでリンク貼っておきます</p>

<p><a href="http://docs.python.jp/3/howto/regex.html#regex-howto">http://docs.python.jp/3/howto/regex.html#regex-howto</a></p>

<h4>0.まずはとりあえず使ってみる</h4>

<p>[Ruby]</p>

<pre class="lang:ruby decode:true"># coding:utf-8

str = "hello"
r = Regexp.new(/h.*o/)

if /h.*o/ =~ str
    p "match!"
else
    p "no match..."
end

if r =~ str
    p "match!!"
else
    p "oh...no match..."
end</pre>


<p>インポートは特別必要ないみたいです。明示的にインスタンスを生成したければRegexp.new(/パターン/)、文字リテラル（1つ目のif文の箇所）でそのままでもOKです。 コンストラクタに与える引数は/(スラッシュ)で囲っても、クォーテーションで囲ってもOKです。</p>

<p>あと、 =~ ってどういう演算子なんだろう・・・と調べてたんですが、これはRegexpクラスのパターンマッチを行うメソッドでした。</p>

<p>ちなみに上記のif文は二つともマッチングします。</p>

<p>[Python]</p>

<pre class="lang:python decode:true"># coding:utf-8

import re

def main():
    str = "hello"
    p = re.compile("h.*o")
    m = p.match(str)

    if m != None:
        print "match!"
    else:
        print "no match..."

if __name__ == "__main__":
    main()</pre>


<p>対してPythonはre モジュールのインポートが必要になります。</p>

<p>re.compile(&#8220;パターン&#8221;)でインスタンスを生成できます。Pythonのマッチングのチェックには４つのメソッドがあって</p>

<p>・match()　文字列の先頭からマッチするかチェック</p>

<p>・search()　文字列を全体から、どこにマッチするかをチェック</p>

<p>・findall()　文字列内のマッチする箇所全てをリストにして返す</p>

<p>・finditer　文字列内のマッチする箇所全てをイテレータとして返す</p>

<p>上記のサンプルでは&#8221;hello&#8221;をmatch()でチェックしマッチングしますが、例えば&#8221;Bob, hello!&#8221;など、文の頭からマッチングしていなければNoneが帰ってきます。findallは後で試しますが、文章中から特定の文字列 のマッチングをしたいときはsearch()のほうがよさそうです。</p>

<p>&nbsp;</p>

<h4>1.特定の文字列パターンにマッチさせる</h4>

<p>前項で既に簡単なサンプルを挙げてしまいましたが、もうちょっと使えそうなやつを・・・・。</p>

<p>んー、でも使えるやつってなんでしょ・・・ｗEメールのマッチングとか、便利なんですけど、ちょっと難易度高いので</p>

<p>・base64に使われている文字列をマッチングさせる</p>

<p>・URL全体からドメイン名をマッチングさせる</p>

<p>の二種類を試します。これRubyとPythonの正規表現、じゃなくて普通に正規表現のはなしになってるかな・・・。まぁよく覚えてないので、そこも含めて復習します・・・。</p>

<p>&nbsp;</p>

<p>base64に使われている文字は大文字AからZと小文字aからz、数字の１から９、そして記号の+,/,=です。この文字列のみを含むものと、そうでないものをマッチングさせてみます。</p>

<p>[Ruby]</p>

<pre class="lang:ruby decode:true"># coding:utf-8
#
if ARGV.size != 1
    p "usage: " &lt;&lt; $0 &lt;&lt; " " &lt;&lt; "&lt;string&gt;"
    exit
end

str = ARGV[0]
reg = Regexp.new(/^[A-Za-z0-9\/+]*=*$/)

if reg =~ str
    p "match!"
else
    p "no match..."
end</pre>


<p>引数に与えた文字列がbase64のものであればマッチングします。（多分間違ってないよね・・・？）</p>

<p>rubyはRailsでの開発で使っただけだったので、コマンドライン引数を取得するところから調べました・・・ｗ</p>

<p>&nbsp;</p>

<p>[Python]</p>

<pre class="lang:default decode:true"># coding:utf-8

import re
import sys

def main():

    argvs = sys.argv
    if len(argvs) is 1:
        print "usage: ",argvs[0], "&lt;string&gt;"
        exit()

    str = argvs[1]
    p = re.compile(r"^[A-Za-z0-9\/+]*=*$")
    m = p.search(str)

    if m is None:
        print "no match..."
    else:
        print "match!!"

if __name__ == "__main__":
    main()</pre>


<p>コマンドライン引数を得るために、sysモジュールをインポートしてあります。</p>

<p>あとはほとんどRubyと同じ。ひとつポイントは</p>

<pre>p = re.compile(r"^[A-Za-z0-9\/+]*=*$")</pre>


<p>の箇所。パターンの前に小文字のrがありますね。ちゃんとした説明やrをつける理由は一番上に貼ったリンクにありますが、すごく簡単にいうと、正規表現のパターンを宣言するときはrつけると簡単、って感じ。</p>

<p>※公式でも「実行遅いけど、読みやすく簡単だよ！」という触れ込み（笑）</p>

<p>&nbsp;</p>

<p>次はドメインをマッチングしたいと思います。</p>

<p>下記の条件にマッチングさせてみます</p>

<p>１．<a href="http://tamago.servehttp.com/blog/%E3%81%AF%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%97%E3%81%AA%E3%81%84">http://tamago.servehttp.com/blog/%E3%81%AF%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%97%E3%81%AA%E3%81%84</a></p>

<p>２．<a href="http://tamago.servehttp.com%E3%81%AB%E3%81%AF%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B">http://tamago.servehttp.com%E3%81%AB%E3%81%AF%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B</a></p>

<p>[Ruby]</p>

<pre class="lang:ruby decode:true"># coding:utf-8
#

if ARGV.size != 1
    p "usage: " &lt;&lt; $0 &lt;&lt; " " &lt;&lt; "&lt;string&gt;"
    exit
end

str = ARGV[0]
reg = Regexp.new(/^(https?|ftp):\/\/[A-Za-z0-9\.]*$/)

if reg =~ str
    p "match!"
else
    p "no match..."
end</pre>


<p>[python]</p>

<pre class="lang:python decode:true"># coding:utf-8

import re
import sys

def main():

    argvs = sys.argv
    if len(argvs) is 1:
        print "usage: ",argvs[0], "&lt;string&gt;"
        exit()

    str = argvs[1]
    p = re.compile(r"^(https?|ftp):\/\/[A-Za-z0-9\.\-]*$")
    m = p.search(str)

    if m is None:
        print "no match..."
    else:
        print "match!!"

if __name__ == "__main__":
    main()</pre>


<p>こんな感じでいいかな・・・・？とりあえず上記の条件はパスできました。</p>

<p>次からは、文章中からURLや任意の文字パターンを抜き出してみたいと思います。</p>

<p>正規表現に関しては比較するとRubyのほうがコード少なくて済みますね。</p>

<p>&nbsp;</p>

<h4>2.文字列パターンにマッチした文字列を抜き出す</h4>

<p>[Ruby]</p>

<p>パターンにマッチングした文字列を抜き出すにはStringクラスのscanメソッドを利用します。(それ以外だと$0とかの方法があるみたいですが、簡単で、かつ僕の用途に合ってるのはscanだったので、こちらを選びました。)</p>

<pre class="lang:ruby decode:true"># coding:utf-8
#

if ARGV.size != 1
    p "usage: " &lt;&lt; $0 &lt;&lt; " " &lt;&lt; "&lt;string&gt;"
    exit
end

str = ARGV[0]
m = str.scan(/(?:https?|ftp):\/\/[A-Za-z0-9\.]*/)

if m.size != 0
    p m
else
    p "no match...."
end</pre>


<p>マッチングした箇所を抽出することを後方参照と言うらしいのですが、ここでポイントが</p>

<pre>(/(?:https?|ftp):\/\/[A-Za-z0-9\.]*/)</pre>


<p>http,https,ftpのいずれかをマッチングするためのグルーピングがされていますが、頭に?:がついています。これは後方参照をしない、という意味です。</p>

<p>これをしないと、例えば<a href="http://www.facebook.com%E3%82%92%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%95%E3%81%9B%E3%81%9F%E3%81%A8%E3%81%8D%E3%81%AB%E3%80%81%E5%BE%8C%E6%96%B9%E5%8F%82%E7%85%A7%E3%82%92%E8%A1%8C%E3%81%86%E3%81%A8%E3%80%81http://www.facebook.com%E3%81%A8http%E3%81%AE%E4%BA%8C%E3%81%A4%E3%81%8C%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%97%E3%81%BE%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E6%8A%9C%E3%81%8D%E5%87%BA%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%AFhttp://www.facebook.com%E3%81%A0%E3%81%91%E3%81%AA%E3%81%AE%E3%81%A7%E3%80%81%E6%9C%80%E5%88%9D%E3%81%AE%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%AF%E6%98%8E%E7%A4%BA%E7%9A%84%E3%81%AB%E5%BE%8C%E6%96%B9%E5%8F%82%E7%85%A7%E3%81%8C%E4%B8%8D%E8%A6%81%E3%81%A0%E3%81%A8%E3%81%84%E3%81%86%E3%81%93%E3%81%A8%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%97%E3%81%BE%E3%81%99%E3%80%82">http://www.facebook.com%E3%82%92%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%95%E3%81%9B%E3%81%9F%E3%81%A8%E3%81%8D%E3%81%AB%E3%80%81%E5%BE%8C%E6%96%B9%E5%8F%82%E7%85%A7%E3%82%92%E8%A1%8C%E3%81%86%E3%81%A8%E3%80%81http://www.facebook.com%E3%81%A8http%E3%81%AE%E4%BA%8C%E3%81%A4%E3%81%8C%E3%83%9E%E3%83%83%E3%83%81%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%97%E3%81%BE%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E6%8A%9C%E3%81%8D%E5%87%BA%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%AFhttp://www.facebook.com%E3%81%A0%E3%81%91%E3%81%AA%E3%81%AE%E3%81%A7%E3%80%81%E6%9C%80%E5%88%9D%E3%81%AE%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%AF%E6%98%8E%E7%A4%BA%E7%9A%84%E3%81%AB%E5%BE%8C%E6%96%B9%E5%8F%82%E7%85%A7%E3%81%8C%E4%B8%8D%E8%A6%81%E3%81%A0%E3%81%A8%E3%81%84%E3%81%86%E3%81%93%E3%81%A8%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%97%E3%81%BE%E3%81%99%E3%80%82</a></p>

<p>なので、上記のサンプルはhttp,https,ftpのいずれかで始まり、::/の後に大文字A-Z小文字a-z、そして数字の1-9、ドットが含まれる文字列にマッチングします。</p>

<p>&nbsp;</p>

<p>[Python]</p>

<p>Pythonではマッチングした文字列を抽出するには、group()メソッドを呼びます。</p>

<p>先ほどのコードを少しいじるだけ+ findall()を使ってみます。マッチした全ての文字列をリストで返すので、使いやすいかなと思います。</p>

<pre class="lang:default decode:true"># coding:utf-8

import re
import sys

def main():

    argvs = sys.argv
    if len(argvs) is 1:
        print "usage: ",argvs[0], "&lt;string&gt;"
        exit()

    str = argvs[1]
    p = re.compile(r"(?:https?|ftp):\/\/[A-Za-z0-9\.-]*")
    m = p.findall(str)

    if len(m) is 0:
        print "no match..."
    else:
        for n in m:
            print n

if __name__ == "__main__":
    main()</pre>


<p>変数名もうちょっとマシなのつけたほうが良かったかな・・・。さーせんｗ</p>

<p>後方参照にマッチさせない書き方はRubyと一緒ですね。よかった。</p>

<p>&nbsp;</p>

<h4>3.文字列パターンにマッチした文字列を置き換える</h4>

<p>今度はマッチングした文字列のなかから、特定の箇所を置換えてみます。結局何がしたかったか、というと、渡された文字列からURLを抜き出して、それからhttpとかのプロトコルの部分を消す、ということをしたかったのです。</p>

<p>さっき抜き出したのが<a href="http://www.facebook.com%E3%81%AA%E3%81%AE%E3%81%A7%E3%80%81%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AB%E3%81%AFwww.facebook.com%E3%81%A8%E3%81%84%E3%81%86%E5%BD%A2%E5%BC%8F%E3%81%AB%E3%81%97%E3%81%A6%E3%81%84%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82">http://www.facebook.com%E3%81%AA%E3%81%AE%E3%81%A7%E3%80%81%E6%9C%80%E7%B5%82%E7%9A%84%E3%81%AB%E3%81%AFwww.facebook.com%E3%81%A8%E3%81%84%E3%81%86%E5%BD%A2%E5%BC%8F%E3%81%AB%E3%81%97%E3%81%A6%E3%81%84%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82</a></p>

<p>これ、正規表現に詳しい人なら一撃で文字列からwww.facebook.comを抽出することもできるのかもしれませんが、段階を踏んで簡単にできる方法として、<a href="http://%E3%81%AA%E3%81%A9%E3%82%92%E6%8C%87%E6%A8%99%E3%81%AB%E3%81%BE%E3%81%9A%E3%81%AF%E6%8A%BD%E5%87%BA%E3%81%97%E3%82%88%E3%81%86%E3%81%A8%E8%80%83%E3%81%88%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82">http://%E3%81%AA%E3%81%A9%E3%82%92%E6%8C%87%E6%A8%99%E3%81%AB%E3%81%BE%E3%81%9A%E3%81%AF%E6%8A%BD%E5%87%BA%E3%81%97%E3%82%88%E3%81%86%E3%81%A8%E8%80%83%E3%81%88%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82</a></p>

<p>置換えにはStringクラスのgsubメソッドを利用します。</p>

<pre class="lang:ruby decode:true"># coding:utf-8
#

if ARGV.size != 1
    p "usage: " &lt;&lt; $0 &lt;&lt; " " &lt;&lt; "&lt;filepath&gt;"
    exit
end

filepath = ARGV[0]
f = open(filepath)
str = f.read
# reg = Regexp.new(/^(https?|ftp):\/\/[A-Za-z0-9\.]*$/)
ms = str.scan(/(?:https?|ftp):\/\/[A-Za-z0-9\.]*/)

if ms.size != 0
    ms.each do |m|
        p m.gsub(/(?:https?|ftp):\/\//, '')
    end
else
    p "no match...."
end</pre>


<p>コマンドライン引数にファイルパスを指定してやると、その中からドメインを抜き出します。</p>

<p>gsubの使い方はscanと変わりません。第二引数に置換え後の文字列を与えるだけです。今回は<a href="http://%E3%81%AA%E3%81%A9%E3%82%92%E6%B6%88%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%A7%E3%80%81%E7%AC%AC%E4%BA%8C%E5%BC%95%E6%95%B0%E3%81%AF%E7%A9%BA%E3%81%A7%E3%81%99%E3%80%82">http://%E3%81%AA%E3%81%A9%E3%82%92%E6%B6%88%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%A7%E3%80%81%E7%AC%AC%E4%BA%8C%E5%BC%95%E6%95%B0%E3%81%AF%E7%A9%BA%E3%81%A7%E3%81%99%E3%80%82</a></p>

<p>&nbsp;</p>

<p>[Python]</p>

<pre class="lang:default decode:true"># coding:utf-8

import re
import sys

def main():

    argvs = sys.argv
    if len(argvs) is 1:
        print "usage: ",argvs[0], "&lt;string&gt;"
        exit()

    filepath = argvs[1]
    f = open(filepath)
    p1 = re.compile(r"(?:https?|ftp):\/\/[A-Za-z0-9\.-]*")  #文字列全体からURLを抽出

    m = p1.findall(f.read())

    if len(m) is 0:
        print "no match..."
    else:
        for n in m:
            print re.sub(r'(?:https?|ftp):\/\/', '' , n)    #置換

if __name__ == "__main__":
    main()</pre>


<p>置換えのメソッドはsubです。 上記のサンプルではreクラスからsub呼び出していますが、マッチングのためのインスタンスを生成して、インスタンスからsubメソッドを呼び出すこともできます。</p>

<pre class="lang:default decode:true">str = argvs[1]
    p1 = re.compile(r"(?:https?|ftp):\/\/")
        print p1.sub('', str)</pre>


<p>プロトコルの部分だけをマッチングさせるインスタンスを別途作成しました。これもうちょっと簡単にする方法あるかな・・・・。</p>

<p>正規表現に関しては個人的にはRubyのほうが直感的で使いやすいかも。</p>

<p>&nbsp;</p>

<p>基礎的な部分なんだけど、使いたいときにサッと出てこないことが多かったので、以上メモです。入門の入門的な。</p>

<p>&nbsp;</p>

<p>追記</p>

<p>４．おまけ　Python &amp; Ruby　リストの重複を排除する</p>

<p>上記の項目３で、指定したファイルからドメインを抽出するスクリプトを書きましたが、重複したドメインが表示されてしまいます。試しにfacebookのトップページからドメインを抽出してみたところ、膨大な重複が検出されました。（当たり前だけど）</p>

<p>そこでそれぞれ重複を排除し、利用されているドメインの一覧を表示するように変更します。</p>

<p>[Rubyにおける重複の排除]</p>

<pre class="lang:ruby decode:true">ms.uniq!</pre>


<p>もともとのインスタンス(この場合 変数ms)の状態を残しておきたければ最後の！マークを取って変数に代入すればOKです（破壊的メソッドか、否か）</p>

<p>&nbsp;</p>

<p>[Pythonにおける重複の排除]</p>

<pre class="lang:python decode:true">l = list(set(m))</pre>


<p>pythonの場合は一件ちょっと複雑ですが、もともとのリスト（変数m）を重複を持たないデータ構造のsetへ変換（set()関数で）</p>

<p>それからlist()関数でlistへ変換。別にset()のままでもいい時はset(m)だけでもいいと思います。</p>

<p>&nbsp;</p>

<p>これを抽出したドメインのリストに対して処理すれば、すべてユニークになります。</p>

<p>&nbsp;</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/08/octopressniyi-xing-sitemimasita/">Octopressに移行してみました</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/28/wordpress77/">簡易プロセス死活監視プログラムをc#で</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/25/wordpress76/">xv6のソースコードとテキストを読んでみる1_chapter0_2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/19/wordpress75/">[CSCamp CTF]解けなかった問題forensics1のwriteupを読んでみた</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/18/wordpress74/">Vagrant + Chef solo + Berkshelfを試してみたのでまとめ</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/KentaKomai">@KentaKomai</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'KentaKomai',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 -  Kenta Komai <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> + <a href="https://github.com/ioveracker/mnml">mnml</a>.
	  
  </span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
