
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>CodeGate2012 Forensics 200を解いてみる - KentaKomai's BLOG</title>
  <meta name="author" content="Kenta Komai">

  
  <meta name="description" content="前回に引き続きCodeGate2012の復習とか ※注意 他の方のwriteupを参考に解いています。（許可とってないのでリンクは貼りませんが、ぐぐってすぐ出てくる海外の方のブログを色々参考にさせていただいています。）
できれば全問触りたいのでwriteupを見ることを前提で解き初めてます。 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://KentaKomai.github.io/blog/2013/02/14/wordpress3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="KentaKomai's BLOG" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
	<div class="header-title"><a href="/">KentaKomai's BLOG</a></div>


	<br><div class="header-subtitle">自分用備忘録の延長</div>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:KentaKomai.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
  
    
      <h1 class="entry-title">CodeGate2012 Forensics 200を解いてみる</h1>
    
  
    
      <p class="meta">
        








  


<time datetime="2013-02-14T00:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>前回に引き続きCodeGate2012の復習とか</p>

<p>※注意</p>

<ul>
<li>他の方のwriteupを参考に解いています。（許可とってないのでリンクは貼りませんが、ぐぐってすぐ出てくる海外の方のブログを色々参考にさせていただいています。）</li>
<li>できれば全問触りたいのでwriteupを見ることを前提で解き初めてます。</li>
</ul>


<p>問題文</p>

<blockquote><p>When IU who lives in Seoul tried to do SQL Injection attack a certain WEB site, suddenly the browser was closed abnormally. What is the SQL Injection value she tried to enter and when the browser was closed? The time is based on Korea Standard Time(UTC +09:00)</p>

<p>Time Format is YYYY-MM-DDThh:mm:ssTZD (TZD : +hh:mm or hh:mm)<br/>
Answer : injection_value|time<br/>
(‘|’ is just a character)<br/>
Convert ‘ ‘ to ‘_’ for injection value.</p></blockquote>

<p>ざっくり意訳</p>

<blockquote><p>ソウル在住のIUがあるWEBサイトへSQLインジェクション攻撃を試した際に、突然ブラウザが以上終了してしまった。ブラウザが閉じてしまった時間と彼女が行ったSQLインジェクションの値を答えてください。</p>

<p>時間は韓国標準時刻(UTC +09:00)</p>

<p>答えは  SQLインジェクションの値|時間　の形式です。</p>

<p>スペースはアンダーバーに置き換えてください。</p></blockquote>

<p>&nbsp;</p>

<p>こんな感じですね。いってみます！ほとんど他の方のWriteupの再現を、って感じですが。</p>

<p>問題ファイルはforensics100の問題と同様、7zip圧縮されてるwindowsのUsersフォルダですね。</p>

<p>この問題でのポイントは</p>

<ul>
<li>SQLインジェクションをしてたらブラウザが落ちた</li>
</ul>


<p>の一点ですね。ちなみにforensics100でproneerはCFOの名前かと思ってましたが、このハッカーのおねーさん（年齢は分からないけどｗ）の名前っぽいですね。失礼しました・・・。</p>

<p>WindowsのUsersフォルダが見れる場合、そのユーザが使ってる可能性があるアプリケーションの情報をチェックしたい場合は/Users/[user name]/AppData/Roaming/内をとりあえず覗いてみる、ってのは定石として良いかもしれませんね。（他の方は当然やってるかもしれませんが）ザックリですいませんが、上記フォルダからMozilla/Firefoxフォルダの中にいろいろあります。</p>

<p>ここで備忘録のためにメモしておくのですが、writeupを書かれてる方は、スパっとFirefoxのフォルダにたどり着いているのですが、この/Users/proneer/AppData/のなかを見る限りInternet Explorerもインストールされてる様なんです。どういう手順でfirefoxのフォルダにたどり着いたか気になります・・。チームで出てる場合は人数分けたりしても良いかもですね。どのみち、ブラウザが落ちた、ということに着目すれば、ブラウザの情報に何かしら情報が残っているかも、という流れにはなりますね。</p>

<p>ここで着目するのが、Profiles/075lfxbt.default/sessionstore.js</p>

<p>Firefoxにはデフォルトでセッションストア機能っていうのがあって、PCのダウンなどにより、意図してないアプリケーションの終了があった場合に、タブや状態などを復元してくれる機能らしいです。（Chromeにもありますね。IEとかsafariはどうなんだろ・・・ちょっと宿題に。）つまり定期的にブラウザの状態をファイルに保存していて、ダウンの際に復元できるように備えてあるわけです。</p>

<p>このファイルを確認すると</p>

<p><a href="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-14.40.05.png" rel="image_group"><img class="alignnone size-large wp-image-44" alt="Screen Shot 2013-02-14 at 14.40.05" src="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-14.40.05.png?resize=625%2C103" data-recalc-dims="1" /></a></p>

<p><a href="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-14.40.22.png" rel="image_group"><img class="alignnone size-medium wp-image-45" alt="Screen Shot 2013-02-14 at 14.40.22" src="http://i2.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-14.40.22.png?resize=300%2C127" data-recalc-dims="1" /></a></p>

<p>見つかりますね。フォーム入力できるページへのアクセスはいくつかありますが、値を入力してる箇所はここだけ。（しかも思いっきりSQL文っぽいし）日付はlastUpdateの値がそれです。writeup見ながらだからサクサクと理解しながら解けましたが、ここにサラっとたどり着くには知識がないとダメですね・・・。</p>

<p>ここから日付時刻(1328976025895)を問題文で指定されたフォーマットに変換してあげます。</p>

<p>コードはGithubにあげました。<a href="https://github.com/KentaKomai/CodeGate2012/blob/master/codegate2012_forensics200.py">コード</a><br/>
<a href="http://i0.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-23.34.07.png" rel="image_group"><img class="alignnone size-large wp-image-46" alt="Screen Shot 2013-02-14 at 23.34.07" src="http://i0.wp.com/tamago.servehttp.com/blog/wp-content/uploads/2013/02/Screen-Shot-2013-02-14-at-23.34.07.png?resize=625%2C43" data-recalc-dims="1" /></a></p>

<p>実はpythonでUNIX標準時間をW3C-DTF形式にするところがめっちゃ時間かかった・・・</p>

<p>今回ここが一番勉強になったかもしれません・・・PHPならワンライナーでできたんですが・・・</p>

<p>後ろに+09:00というようにUTC時刻との差が表示されるやつです。コードにあるように結局は拡張モジュール使いました。ぐぬぬ・・・</p>

<p>しかも形式が+09:00ではなく、+0900がデフォルトで、強引に正規表現で整形するという・・・プログラム書く意味ないじゃん！！！！</p>

<p>&nbsp;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">k.komai</span></span>

      








  


<time datetime="2013-02-14T00:00:00+09:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/wei-fen-lei/'>未分類</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://KentaKomai.github.io/blog/2013/02/14/wordpress3/" data-via="TAMAGO_MAGO_2" data-counturl="http://KentaKomai.github.io/blog/2013/02/14/wordpress3/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/02/13/wordpress2/" title="Previous Post: CodeGate2012 Forensics 100 解いてみる">&laquo; CodeGate2012 Forensics 100 解いてみる</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/02/15/wordpress4/" title="Next Post: CodeGate2012 Forensics300を解いてみる">CodeGate2012 Forensics300を解いてみる &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/11/28/wordpress77/">簡易プロセス死活監視プログラムをc#で</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/25/wordpress76/">xv6のソースコードとテキストを読んでみる1_chapter0_2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/19/wordpress75/">[CSCamp CTF]解けなかった問題forensics1のwriteupを読んでみた</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/18/wordpress74/">Vagrant + Chef solo + Berkshelfを試してみたのでまとめ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/10/wordpress73/">xv6のソースコードとテキストを読んでみる1_chapter0_1</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 -  Kenta Komai <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> + <a href="https://github.com/ioveracker/mnml">mnml</a>.
	  
  </span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
